<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Desafio Java - Listagem de Salários</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; }
        .ui-panel .ui-panel-titlebar { font-size: 1.2em !important; }
        .button-row p-button { margin-right: 10px; }
    </style>
</h:head>

<h:body>
    <p:growl id="messages" showDetail="true" life="6000" />

    <h:form id="formPrincipal">
        <p:panel header="Ações do Sistema">
            <p:commandButton value="Calcular Salários (Assíncrono)"
                             actionListener="#{pessoaSalarioBean.calcularSalarios}"
                             update="messages"
                             icon="pi pi-bolt" />

            <p:button value="Gerir Pessoas" outcome="pessoas" icon="pi pi-users" style="margin-left: 10px;"/>

            <p:button value="Gerir Utilizadores" outcome="usuarios" icon="pi pi-key" style="margin-left: 10px;"/>

            <p:commandButton value="Exportar para PDF" icon="pi pi-file-pdf"
                             actionListener="#{pessoaSalarioBean.gerarRelatorio}"
                             ajax="false"
                             style="margin-left: 10px;"/>

            <p:commandButton value="Sair" action="#{loginBean.efetuarLogout}"
                             icon="pi pi-sign-out"
                             ajax="false"
                             style="margin-left: 10px;"/>
        </p:panel>

        <br/>

        <p:panel header="Listagem de Pessoas e Salários Consolidados">
            <p:poll interval="5" listener="#{pessoaSalarioBean.carregarPessoas}" update="tabelaPessoas" />

            <p:dataTable id="tabelaPessoas" var="pessoa" value="#{pessoaSalarioBean.pessoas}"
                         paginator="true"
                         rows="15"
                         rowsPerPageTemplate="15,30,50"
                         emptyMessage="Nenhum registo encontrado. Clique no botão 'Calcular' para popular os dados."
                         paginatorPosition="bottom">

                <p:column headerText="ID" sortBy="#{pessoa.pessoaId}" style="width: 80px; text-align: center;">
                    <h:outputText value="#{pessoa.pessoaId}" />
                </p:column>

                <p:column headerText="Nome" sortBy="#{pessoa.nome}" filterBy="#{pessoa.nome}" filterMatchMode="contains">
                    <h:outputText value="#{pessoa.nome}" />
                </p:column>

                <p:column headerText="Cargo" sortBy="#{pessoa.cargo}" style="width: 250px;">
                    <h:outputText value="#{pessoa.cargo}" />
                </p:column>

                <p:column headerText="Salário (R$)" sortBy="#{pessoa.salario}" style="width: 150px; text-align: right;">
                    <h:outputText value="#{pessoa.salario}">
                        <f:convertNumber type="currency" currencySymbol="R$ " locale="pt_BR" />
                    </h:outputText>
                </p:column>

            </p:dataTable>
        </p:panel>
    </h:form>

</h:body>
</html>